import{c as K,d as U,l as $,an as lt,t as ut,b as B,i as dt,s as Y,G as X,A as F,a as m,ao as ht,y as ft,n as Z,K as pt,ap as _t,Y as E,T as L,D as vt,aq as mt,ar as q,p as gt,N as yt,o as xt,e as kt,as as Ct,at as St,w as J,_ as Q,ac as W,Z as _,$ as k,ak as tt,a2 as N,a9 as I,aa as D,a4 as Tt,ag as V,a6 as O,a8 as bt,a3 as wt,a5 as At,ai as It,aj as Rt}from"./index-2735b714.js";import{T as $t,a as Dt}from"./index-c1dbe867.js";import{u as Ot}from"./index-313c0163.js";import{C as Bt,S as Pt}from"./index-4ba5a9fa.js";import{u as et}from"./city-c094342b.js";import{u as ot}from"./index-868c3cdd.js";import"./use-id-0ce2db57.js";import"./use-refs-09391ae5.js";function Et(){const t="A".charCodeAt(0);return Array(26).fill("").map((o,c)=>String.fromCharCode(t+c))}const[nt,P]=K("index-bar"),Lt={sticky:ft,zIndex:Z,teleport:[String,Object],highlightColor:String,stickyOffsetTop:pt(0),indexList:{type:Array,default:Et}},st=Symbol(nt);var Nt=U({name:nt,props:Lt,emits:["select","change"],setup(t,{emit:v,slots:o}){const c=$(),g=$(),l=$(""),u=Ot(),d=lt(c),{children:n,linkChildren:f}=ut(st);let a;f({props:t});const y=B(()=>{if(dt(t.zIndex))return{zIndex:+t.zIndex+1}}),w=B(()=>{if(t.highlightColor)return{color:t.highlightColor}}),i=(e,s)=>{for(let r=n.length-1;r>=0;r--){const p=r>0?s[r-1].height:0,h=t.sticky?p+t.stickyOffsetTop:0;if(e+h>=s[r].top)return r}return-1},C=e=>n.find(s=>String(s.index)===e),S=()=>{if(_t(c))return;const{sticky:e,indexList:s}=t,r=E(d.value),p=L(d),h=n.map(A=>A.getRect(d.value,p));let T=-1;if(a){const A=C(a);if(A){const b=A.getRect(d.value,p);T=i(b.top,h)}}else T=i(r,h);l.value=s[T],e&&n.forEach((A,b)=>{const{state:x,$el:rt}=A;if(b===T||b===T-1){const R=rt.getBoundingClientRect();x.left=R.left,x.width=R.width}else x.left=null,x.width=null;if(b===T)x.active=!0,x.top=Math.max(t.stickyOffsetTop,h[b].top-r)+p.top;else if(b===T-1&&a===""){const R=h[T].top-r;x.active=R>0,x.top=R+p.top-h[b].height}else x.active=!1}),a=""},M=()=>{vt(S)};Y("scroll",S,{target:d,passive:!0}),X(M),F(()=>t.indexList,M),F(l,e=>{e&&v("change",e)});const ct=()=>t.indexList.map(e=>{const s=e===l.value;return m("span",{class:P("index",{active:s}),style:s?w.value:void 0,"data-index":e},[e])}),z=e=>{a=String(e);const s=C(a);if(s){const r=E(d.value),p=L(d),{offsetHeight:h}=document.documentElement;if(s.$el.scrollIntoView(),r===h-p.height){S();return}t.sticky&&t.stickyOffsetTop&&mt(q()-t.stickyOffsetTop),v("select",s.index)}},j=e=>{const{index:s}=e.dataset;s&&z(s)},at=e=>{j(e.target)};let G;const it=e=>{if(u.move(e),u.isVertical()){gt(e);const{clientX:s,clientY:r}=e.touches[0],p=document.elementFromPoint(s,r);if(p){const{index:h}=p.dataset;h&&G!==h&&(G=h,j(p))}}},H=()=>m("div",{ref:g,class:P("sidebar"),style:y.value,onClick:at,onTouchstartPassive:u.start},[ct()]);return ot({scrollTo:z}),Y("touchmove",it,{target:g}),()=>{var e;return m("div",{ref:c,class:P()},[t.teleport?m(ht,{to:t.teleport},{default:()=>[H()]}):H(),(e=o.default)==null?void 0:e.call(o)])}}});const[Vt,Mt]=K("index-anchor"),zt={index:Z};var jt=U({name:Vt,props:zt,setup(t,{slots:v}){const o=yt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),c=$(),{parent:g}=xt(st);if(!g)return;const l=()=>o.active&&g.props.sticky,u=B(()=>{const{zIndex:n,highlightColor:f}=g.props;if(l())return kt(Ct(n),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:f})});return ot({state:o,getRect:(n,f)=>{const a=L(c);return o.rect.height=a.height,n===window||n===document.body?o.rect.top=a.top+q():o.rect.top=a.top+E(n)-f.top,o.rect}}),()=>{const n=l();return m("div",{ref:c,style:{height:n?`${o.rect.height}px`:void 0}},[m("div",{style:u.value,class:[Mt({sticky:n}),{[St]:n}]},[v.default?v.default():t.index])])}}});const Gt=J(jt),Ht=J(Nt);const Yt={class:"city-group"},Ft={class:"list"},Kt=["onClick"],Ut={__name:"city-group",props:{groupData:{type:Object,default:()=>({})}},setup(t){const v=t,o=et(),c=B(()=>{const u=v.groupData.cities.map(d=>d.group);return u.unshift("#"),u}),g=W(),l=u=>{o.currentCity=u,g.back()};return(u,d)=>{const n=Gt,f=Bt,a=Ht;return _(),k("div",Yt,[m(a,{"highlight-color":"#ff9854","index-list":O(c)},{default:tt(()=>[m(n,{index:"热门"}),N("div",Ft,[(_(!0),k(I,null,D(t.groupData.hotCities,(y,w)=>(_(),k("div",{key:w,class:"city",onClick:i=>l(y)},Tt(y.cityName),9,Kt))),128))]),(_(!0),k(I,null,D(t.groupData.cities,(y,w)=>(_(),k(I,{key:w},[m(n,{index:y.group},null,8,["index"]),(_(!0),k(I,null,D(y.cities,(i,C)=>(_(),V(f,{key:C,title:i.cityName,onClick:S=>l(i)},null,8,["title","onClick"]))),128))],64))),128))]),_:1},8,["index-list"])])}}},Xt=Q(Ut,[["__scopeId","data-v-d864e208"]]);const Zt={class:"city top-page"},qt={class:"top"},Jt={class:"content"},Qt={__name:"city",setup(t){const v=et(),{allCity:o,searchValue:c}=bt(v),g=wt();X(()=>{v.getCityAll(),g.isShowTab=!1});const l=$(0),u=W(),d=()=>{u.back()};return(n,f)=>{const a=Pt,y=Dt,w=$t;return _(),k("div",Zt,[N("div",qt,[m(a,{modelValue:O(c),"onUpdate:modelValue":f[0]||(f[0]=i=>At(c)?c.value=i:null),shape:"round","show-action":"",placeholder:"城市/区域/位置",onCancel:d},null,8,["modelValue"]),m(w,{active:l.value,"onUpdate:active":f[1]||(f[1]=i=>l.value=i),color:"#ff9854"},{default:tt(()=>[(_(!0),k(I,null,D(O(o),(i,C,S)=>(_(),V(y,{key:S,title:i.title,name:C},null,8,["title","name"]))),128))]),_:1},8,["active"])]),N("div",Jt,[(_(!0),k(I,null,D(O(o),(i,C,S)=>It((_(),V(Xt,{key:S,"group-data":i},null,8,["group-data"])),[[Rt,C===l.value]])),128))])])}}},ie=Q(Qt,[["__scopeId","data-v-4acf5f1b"]]);export{ie as default};
