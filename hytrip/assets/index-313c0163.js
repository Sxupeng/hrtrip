import{l as y,c as U,y as $,n as G,x as _,d as j,N as q,t as re,b,A,ax as ve,aG as fe,aY as de,G as F,ah as he,ay as ge,au as me,av as we,s as be,a as D,ap as K,D as J,aD as M,p as pe,h as k,w as Q,o as ye}from"./index-2735b714.js";import{u as Z}from"./index-868c3cdd.js";function Te(t,f){return t>f?"horizontal":f>t?"vertical":""}function xe(){const t=y(0),f=y(0),d=y(0),o=y(0),c=y(0),e=y(0),h=y(""),v=()=>h.value==="vertical",p=()=>h.value==="horizontal",u=()=>{d.value=0,o.value=0,c.value=0,e.value=0,h.value=""};return{move:s=>{const w=s.touches[0];d.value=(w.clientX<0?0:w.clientX)-t.value,o.value=w.clientY-f.value,c.value=Math.abs(d.value),e.value=Math.abs(o.value);const x=10;(!h.value||c.value<x&&e.value<x)&&(h.value=Te(c.value,e.value))},start:s=>{u(),t.value=s.touches[0].clientX,f.value=s.touches[0].clientY},reset:u,startX:t,startY:f,deltaX:d,deltaY:o,offsetX:c,offsetY:e,direction:h,isVertical:v,isHorizontal:p}}const[ee,Y]=U("swipe"),Se={loop:$,width:G,height:G,vertical:Boolean,autoplay:_(0),duration:_(500),touchable:$,lazyRender:Boolean,initialSwipe:_(0),indicatorColor:String,showIndicators:$,stopPropagation:$},te=Symbol(ee);var Ce=j({name:ee,props:Se,emits:["change","dragStart","dragEnd"],setup(t,{emit:f,slots:d}){const o=y(),c=y(),e=q({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let h=!1;const v=xe(),{children:p,linkChildren:u}=re(te),i=b(()=>p.length),r=b(()=>e[t.vertical?"height":"width"]),s=b(()=>t.vertical?v.deltaY.value:v.deltaX.value),w=b(()=>e.rect?(t.vertical?e.rect.height:e.rect.width)-r.value*i.value:0),x=b(()=>r.value?Math.ceil(Math.abs(w.value)/r.value):i.value),O=b(()=>i.value*r.value),E=b(()=>(e.active+i.value)%i.value),R=b(()=>{const a=t.vertical?"vertical":"horizontal";return v.direction.value===a}),ae=b(()=>{const a={transitionDuration:`${e.swiping?0:t.duration}ms`,transform:`translate${t.vertical?"Y":"X"}(${e.offset}px)`};if(r.value){const l=t.vertical?"height":"width",n=t.vertical?"width":"height";a[l]=`${O.value}px`,a[n]=t[n]?`${t[n]}px`:""}return a}),ie=a=>{const{active:l}=e;return a?t.loop?k(l+a,-1,i.value):k(l+a,0,x.value):l},N=(a,l=0)=>{let n=a*r.value;t.loop||(n=Math.min(n,-w.value));let m=l-n;return t.loop||(m=k(m,w.value,0)),m},T=({pace:a=0,offset:l=0,emitChange:n})=>{if(i.value<=1)return;const{active:m}=e,g=ie(a),z=N(g,l);if(t.loop){if(p[0]&&z!==w.value){const X=z<w.value;p[0].setOffset(X?O.value:0)}if(p[i.value-1]&&z!==0){const X=z>0;p[i.value-1].setOffset(X?-O.value:0)}}e.active=g,e.offset=z,n&&g!==m&&f("change",E.value)},I=()=>{e.swiping=!0,e.active<=-1?T({pace:i.value}):e.active>=i.value&&T({pace:-i.value})},ne=()=>{I(),v.reset(),M(()=>{e.swiping=!1,T({pace:-1,emitChange:!0})})},B=()=>{I(),v.reset(),M(()=>{e.swiping=!1,T({pace:1,emitChange:!0})})};let H;const C=()=>clearTimeout(H),P=()=>{C(),t.autoplay>0&&i.value>1&&(H=setTimeout(()=>{B(),P()},+t.autoplay))},S=(a=+t.initialSwipe)=>{if(!o.value)return;const l=()=>{var n,m;if(!K(o)){const g={width:o.value.offsetWidth,height:o.value.offsetHeight};e.rect=g,e.width=+((n=t.width)!=null?n:g.width),e.height=+((m=t.height)!=null?m:g.height)}i.value&&(a=Math.min(i.value-1,a),a===-1&&(a=i.value-1)),e.active=a,e.swiping=!0,e.offset=N(a),p.forEach(g=>{g.setOffset(0)}),P()};K(o)?J().then(l):l()},L=()=>S(e.active);let V;const le=a=>{!t.touchable||a.touches.length>1||(v.start(a),h=!1,V=Date.now(),C(),I())},oe=a=>{t.touchable&&e.swiping&&(v.move(a),R.value&&(!t.loop&&(e.active===0&&s.value>0||e.active===i.value-1&&s.value<0)||(pe(a,t.stopPropagation),T({offset:s.value}),h||(f("dragStart"),h=!0))))},W=()=>{if(!t.touchable||!e.swiping)return;const a=Date.now()-V,l=s.value/a;if((Math.abs(l)>.25||Math.abs(s.value)>r.value/2)&&R.value){const m=t.vertical?v.offsetY.value:v.offsetX.value;let g=0;t.loop?g=m>0?s.value>0?-1:1:0:g=-Math[s.value>0?"ceil":"floor"](s.value/r.value),T({pace:g,emitChange:!0})}else s.value&&T({pace:0});h=!1,e.swiping=!1,f("dragEnd"),P()},se=(a,l={})=>{I(),v.reset(),M(()=>{let n;t.loop&&a===i.value?n=e.active===0?0:a:n=a%i.value,l.immediate?M(()=>{e.swiping=!1}):e.swiping=!1,T({pace:n-e.active,emitChange:!0})})},ce=(a,l)=>{const n=l===E.value,m=n?{backgroundColor:t.indicatorColor}:void 0;return D("i",{style:m,class:Y("indicator",{active:n})},null)},ue=()=>{if(d.indicator)return d.indicator({active:E.value,total:i.value});if(t.showIndicators&&i.value>1)return D("div",{class:Y("indicators",{vertical:t.vertical})},[Array(i.value).fill("").map(ce)])};return Z({prev:ne,next:B,state:e,resize:L,swipeTo:se}),u({size:r,props:t,count:i,activeIndicator:E}),A(()=>t.initialSwipe,a=>S(+a)),A(i,()=>S(e.active)),A(()=>t.autoplay,P),A([ve,fe],L),A(de(),a=>{a==="visible"?P():C()}),F(S),he(()=>S(e.active)),ge(()=>S(e.active)),me(C),we(C),be("touchmove",oe,{target:c}),()=>{var a;return D("div",{ref:o,class:Y()},[D("div",{ref:c,style:ae.value,class:Y("track",{vertical:t.vertical}),onTouchstartPassive:le,onTouchend:W,onTouchcancel:W},[(a=d.default)==null?void 0:a.call(d)]),ue()])}}});const Ie=Q(Ce),[Pe,ze]=U("swipe-item");var Ae=j({name:Pe,setup(t,{slots:f}){let d;const o=q({offset:0,inited:!1,mounted:!1}),{parent:c,index:e}=ye(te);if(!c)return;const h=b(()=>{const u={},{vertical:i}=c.props;return c.size.value&&(u[i?"height":"width"]=`${c.size.value}px`),o.offset&&(u.transform=`translate${i?"Y":"X"}(${o.offset}px)`),u}),v=b(()=>{const{loop:u,lazyRender:i}=c.props;if(!i||d)return!0;if(!o.mounted)return!1;const r=c.activeIndicator.value,s=c.count.value-1,w=r===0&&u?s:r-1,x=r===s&&u?0:r+1;return d=e.value===r||e.value===w||e.value===x,d}),p=u=>{o.offset=u};return F(()=>{J(()=>{o.mounted=!0})}),Z({setOffset:p}),()=>{var u;return D("div",{class:ze(),style:h.value},[v.value?(u=f.default)==null?void 0:u.call(f):null])}}});const $e=Q(Ae);export{Ie as S,$e as a,xe as u};
