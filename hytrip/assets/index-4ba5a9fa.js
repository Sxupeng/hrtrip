import{c as G,e as j,r as Le,d as J,u as Pe,a as o,m as E,n as A,y as ie,L as q,i as k,I as N,w as Q,ar as Te,aq as Re,P as Me,aM as Ae,aN as _e,x as Be,N as De,l as W,o as $e,b as D,f as Ne,aE as Oe,A as Fe,D as z,G as ze,s as qe,aO as We,aP as ne,aQ as je,p as Y,aR as Ke,E as oe,ae as He,aS as Ue,v as ae}from"./index-2735b714.js";import{u as ce}from"./use-id-0ce2db57.js";import{u as se}from"./index-868c3cdd.js";const[Ye,M]=G("cell"),ue={tag:E("div"),icon:String,size:String,title:A,value:A,label:A,center:Boolean,isLink:Boolean,border:ie,required:Boolean,iconPrefix:String,valueClass:q,labelClass:q,titleClass:q,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},Ge=j({},ue,Le);var Je=J({name:Ye,props:Ge,setup(e,{slots:n}){const a=Pe(),f=()=>{if(n.label||k(e.label))return o("div",{class:[M("label"),e.labelClass]},[n.label?n.label():e.label])},r=()=>{var c;if(n.title||k(e.title)){const b=(c=n.title)==null?void 0:c.call(n);return Array.isArray(b)&&b.length===0?void 0:o("div",{class:[M("title"),e.titleClass],style:e.titleStyle},[b||o("span",null,[e.title]),f()])}},u=()=>{const c=n.value||n.default;if(c||k(e.value))return o("div",{class:[M("value"),e.valueClass]},[c?c():o("span",null,[e.value])])},L=()=>{if(n.icon)return n.icon();if(e.icon)return o(N,{name:e.icon,class:M("left-icon"),classPrefix:e.iconPrefix},null)},V=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const c=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return o(N,{name:c,class:M("right-icon")},null)}};return()=>{var c;const{tag:b,size:m,center:_,border:P,isLink:B,required:C}=e,S=(c=e.clickable)!=null?c:B,w={center:_,required:C,clickable:S,borderless:!P};return m&&(w[m]=!!m),o(b,{class:M(w),role:S?"button":void 0,tabindex:S?0:void 0,onClick:a},{default:()=>{var x;return[L(),r(),u(),V(),(x=n.extra)==null?void 0:x.call(n)]}})}}});const Qe=Q(Je);function de(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Xe(e,n){if(de(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Ze(e,n){return new Promise(a=>{const f=n.validator(e,n);if(Ae(f)){f.then(a);return}a(f)})}function le(e,n){const{message:a}=n;return _e(a)?a(e,n):a||""}function pe({target:e}){e.composing=!0}function re({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function et(e,n){const a=Te();e.style.height="auto";let f=e.scrollHeight;if(Me(n)){const{maxHeight:r,minHeight:u}=n;r!==void 0&&(f=Math.min(f,r)),u!==void 0&&(f=Math.max(f,u))}f&&(e.style.height=`${f}px`,Re(a))}function tt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function I(e){return[...e].length}function U(e,n){return[...e].slice(0,n).join("")}const[nt,v]=G("field"),X={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:A,formatter:Function,clearIcon:E("clear"),modelValue:Be(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:E("focus"),formatTrigger:E("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},at=j({},ue,X,{rows:A,type:E("text"),rules:Array,autosize:[Boolean,Object],labelWidth:A,labelClass:q,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var lt=J({name:nt,props:at,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const f=ce(),r=De({status:"unvalidated",focused:!1,validateMessage:""}),u=W(),L=W(),V=W(),{parent:c}=$e(We),b=()=>{var t;return String((t=e.modelValue)!=null?t:"")},m=t=>{if(k(e[t]))return e[t];if(c&&k(c.props[t]))return c.props[t]},_=D(()=>{const t=m("readonly");if(e.clearable&&!t){const s=b()!=="",i=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return s&&i}return!1}),P=D(()=>V.value&&a.input?V.value():e.modelValue),B=t=>t.reduce((s,i)=>s.then(()=>{if(r.status==="failed")return;let{value:d}=P;if(i.formatter&&(d=i.formatter(d,i)),!Xe(d,i)){r.status="failed",r.validateMessage=le(d,i);return}if(i.validator)return de(d)&&i.validateEmpty===!1?void 0:Ze(d,i).then(g=>{g&&typeof g=="string"?(r.status="failed",r.validateMessage=g):g===!1&&(r.status="failed",r.validateMessage=le(d,i))})}),Promise.resolve()),C=()=>{r.status="unvalidated",r.validateMessage=""},S=()=>n("endValidate",{status:r.status,message:r.validateMessage}),w=(t=e.rules)=>new Promise(s=>{C(),t?(n("startValidate"),B(t).then(()=>{r.status==="failed"?(s({name:e.name,message:r.validateMessage}),S()):(r.status="passed",s(),S())})):s()}),x=t=>{if(c&&e.rules){const{validateTrigger:s}=c.props,i=ne(s).includes(t),d=e.rules.filter(g=>g.trigger?ne(g.trigger).includes(t):i);d.length&&w(d)}},K=t=>{var s;const{maxlength:i}=e;if(k(i)&&I(t)>i){const d=b();if(d&&I(d)===+i)return d;const g=(s=u.value)==null?void 0:s.selectionEnd;if(r.focused&&g){const h=[...t],y=h.length-+i;return h.splice(g-y,y),h.join("")}return U(t,+i)}return t},T=(t,s="onChange")=>{const i=t;t=K(t);const d=I(i)-I(t);if(e.type==="number"||e.type==="digit"){const h=e.type==="number";t=je(t,h,h)}let g=0;if(e.formatter&&s===e.formatTrigger){const{formatter:h,maxlength:y}=e;if(t=h(t),k(y)&&I(t)>y&&(t=U(t,+y)),u.value&&r.focused){const{selectionEnd:F}=u.value,te=U(i,F);g=I(h(te))-I(te)}}if(u.value&&u.value.value!==t)if(r.focused){let{selectionStart:h,selectionEnd:y}=u.value;if(u.value.value=t,k(h)&&k(y)){const F=I(t);d?(h-=d,y-=d):g&&(h+=g,y+=g),u.value.setSelectionRange(Math.min(h,F),Math.min(y,F))}}else u.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},H=t=>{t.target.composing||T(t.target.value)},l=()=>{var t;return(t=u.value)==null?void 0:t.blur()},O=()=>{var t;return(t=u.value)==null?void 0:t.focus()},R=()=>{const t=u.value;e.type==="textarea"&&e.autosize&&t&&et(t,e.autosize)},fe=t=>{r.focused=!0,n("focus",t),z(R),m("readonly")&&l()},ge=t=>{m("readonly")||(r.focused=!1,T(b(),"onBlur"),n("blur",t),x("onBlur"),z(R),Ue())},Z=t=>n("clickInput",t),me=t=>n("clickLeftIcon",t),be=t=>n("clickRightIcon",t),he=t=>{Y(t),n("update:modelValue",""),n("clear",t)},p=D(()=>{if(typeof e.error=="boolean")return e.error;if(c&&c.props.showError&&r.status==="failed")return!0}),ve=D(()=>{const t=m("labelWidth");if(t)return{width:Ne(t)}}),ye=t=>{t.keyCode===13&&(!(c&&c.props.submitOnEnter)&&e.type!=="textarea"&&Y(t),e.type==="search"&&l()),n("keypress",t)},ee=()=>e.id||`${f}-input`,Ie=()=>r.status,ke=()=>{const t=v("control",[m("inputAlign"),{error:p.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return o("div",{class:t,onClick:Z},[a.input()]);const s={id:ee(),ref:u,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:m("disabled"),readonly:m("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${f}-label`:void 0,onBlur:ge,onFocus:fe,onInput:H,onClick:Z,onChange:re,onKeypress:ye,onCompositionend:re,onCompositionstart:pe};return e.type==="textarea"?o("textarea",s,null):o("input",oe(tt(e.type),s),null)},Ce=()=>{const t=a["left-icon"];if(e.leftIcon||t)return o("div",{class:v("left-icon"),onClick:me},[t?t():o(N,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Se=()=>{const t=a["right-icon"];if(e.rightIcon||t)return o("div",{class:v("right-icon"),onClick:be},[t?t():o(N,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},xe=()=>{if(e.showWordLimit&&e.maxlength){const t=I(b());return o("div",{class:v("word-limit")},[o("span",{class:v("word-num")},[t]),He("/"),e.maxlength])}},Ve=()=>{if(c&&c.props.showErrorMessage===!1)return;const t=e.errorMessage||r.validateMessage;if(t){const s=a["error-message"],i=m("errorMessageAlign");return o("div",{class:v("error-message",i)},[s?s({message:t}):t])}},we=()=>{const t=m("colon")?":":"";if(a.label)return[a.label(),t];if(e.label)return o("label",{id:`${f}-label`,for:ee()},[e.label+t])},Ee=()=>[o("div",{class:v("body")},[ke(),_.value&&o(N,{ref:L,name:e.clearIcon,class:v("clear")},null),Se(),a.button&&o("div",{class:v("button")},[a.button()])]),xe(),Ve()];return se({blur:l,focus:O,validate:w,formValue:P,resetValidation:C,getValidationStatus:Ie}),Oe(Ke,{customValue:V,resetValidation:C,validateWithTrigger:x}),Fe(()=>e.modelValue,()=>{T(b()),C(),x("onChange"),z(R)}),ze(()=>{T(b(),e.formatTrigger),z(R)}),qe("touchstart",he,{target:D(()=>{var t;return(t=L.value)==null?void 0:t.$el})}),()=>{const t=m("disabled"),s=m("labelAlign"),i=Ce(),d=()=>{const g=we();return s==="top"?[i,g].filter(Boolean):g||[]};return o(Qe,{size:e.size,class:v({error:p.value,disabled:t,[`label-${s}`]:s}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:ve.value,valueClass:v("value"),titleClass:[v("label",[s,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:i&&s!=="top"?()=>i:null,title:d,value:Ee,extra:a.extra})}}});const rt=Q(lt),[it,$,ot]=G("search"),ct=j({},X,{label:String,shape:E("square"),leftIcon:E("search"),clearable:ie,actionText:String,background:String,showAction:Boolean});var st=J({name:it,props:ct,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:f}){const r=ce(),u=W(),L=()=>{a.action||(n("update:modelValue",""),n("cancel"))},V=l=>{l.keyCode===13&&(Y(l),n("search",e.modelValue))},c=()=>e.id||`${r}-input`,b=()=>{if(a.label||e.label)return o("label",{class:$("label"),for:c()},[a.label?a.label():e.label])},m=()=>{if(e.showAction){const l=e.actionText||ot("cancel");return o("div",{class:$("action"),role:"button",tabindex:0,onClick:L},[a.action?a.action():l])}},_=()=>{var l;return(l=u.value)==null?void 0:l.blur()},P=()=>{var l;return(l=u.value)==null?void 0:l.focus()},B=l=>n("blur",l),C=l=>n("focus",l),S=l=>n("clear",l),w=l=>n("clickInput",l),x=l=>n("clickLeftIcon",l),K=l=>n("clickRightIcon",l),T=Object.keys(X),H=()=>{const l=j({},f,ae(e,T),{id:c()}),O=R=>n("update:modelValue",R);return o(rt,oe({ref:u,type:"search",class:$("field"),border:!1,onBlur:B,onFocus:C,onClear:S,onKeypress:V,onClickInput:w,onClickLeftIcon:x,onClickRightIcon:K,"onUpdate:modelValue":O},l),ae(a,["left-icon","right-icon"]))};return se({focus:P,blur:_}),()=>{var l;return o("div",{class:$({"show-action":e.showAction}),style:{background:e.background}},[(l=a.left)==null?void 0:l.call(a),o("div",{class:$("content",e.shape)},[b(),H()]),m()])}}});const gt=Q(st);export{Qe as C,gt as S};
